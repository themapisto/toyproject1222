<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="prjc.baechan.admin.AdminDAO">
	<select id="couponList" parameterType="prjc.baechan.common.CouponDTO" resultType="prjc.baechan.common.CouponVO">
		select *
		from coupon
		where couponChk = 'N'
		order by registStartDt desc, registEndDt desc
 	</select>
	
	<!-- 쿠폰 등록가능여부 변경 -->
	<update id="couponUpdtRgstChk" >
		update coupon
		set registChk = 
			case
				when registChk = 'Y' then 'N' else 'Y'
			end
		where couponId in
		<foreach item="list" collection="array" open="(" separator="," close=")">
			  #{list}
		</foreach>
	</update>
	
	<!-- 쿠폰 삭제여부 변경 -->
	<update id="couponDeleteAjax" >
		update coupon
		set couponChk = 'Y'
			
		where couponId in
		<foreach item="list" collection="array" open="(" separator="," close=")">
			  #{list}
		</foreach>
	</update>
	
	<!-- 쿠폰 삭제여부 변경 -->
	<insert id="couponMakeAjax" >
		INSERT INTO COUPON (couponId,couponNm,dscntRate,registStartDt,registEndDt,registChk,usePeriod,couponChk)
		VALUES(#{couponId},#{couponNm},#{dscntRate},#{registStartDt},#{registEndDt},'N',#{usePeriod},'N')
	</insert>
	
	<!-- 쿠폰 update 페이지 호출 -->
	<select id="updateCouponView" parameterType="prjc.baechan.common.CouponDTO" resultType="prjc.baechan.common.CouponVO">
		select *
		from coupon
		where couponChk = 'N' and couponId = #{couponId}
 	</select>
 	
 	<update id = "couponUpdateAjax">
 		update coupon
 		set couponNm = #{couponNm}, dscntRate = #{dscntRate} , registStartDt = #{registStartDt}, 
 		registEndDt = #{registEndDt}, usePeriod = #{usePeriod}
 		where couponId = #{couponId}
 	</update>
</mapper>